## 1、http的发展

http/0.9（1991）》》http/1.0（1996）

》》HTTP/1.1（1996）标准化与性能优化 》》HTTP/2（2015）性能飞跃

》》HTTP/3（2022）

## 2、socket套接字



## 思考

### 1、为什么浏览器对同一域名的请求有限制？

- 服务器性能方面

  避免服务器过载：访问一个网站的时候，会对服务器请求很多资源，短时间内大量用户去访问，就会对服务器造成压力，服务器就会奔溃

- 防止网络拥堵

- 抵制一些恶意攻击：有些用户会恶意占用大量服务器连接

不同版本的http对tcp连接会有不同程度的限制：

1. Http1.0：无状态、无连接
   1. 每次请求都需要重新连接：每次http请求都需要建立tcp连接，每一次都需要经历三次握手
   2. 连接无法复用：请求完成之后就关闭tcp连接
   3. 缺乏持久连接标准支持：可添加请求头`Connection: keep - alive`但是非标准要求
2. Http1.1：默认支持持久连接，允许一个TCP连接中发送多个请求
   1. 队头阻塞问题：一个tcp连接的请求是串行的，会依次请求
   2. tcp并发连接限制：同一域名的多个tcp可以并发执行，但是数量有限，一般为6-8个
3. Http2：虽然对 TCP 连接限制有改进，但 TCP 本身仍存在问题
4. Http3：解决了部分 TCP 连接问题

现在的浏览器请求主要使用 HTTP/2 和 HTTP/3 协议，同时 HTTP/1.1 也仍在广泛使用。

### 2、如何证实浏览器对域名的限制？

这是一个请求的waterfall图

![image-20250226100224510](/Users/soup/Library/Application Support/typora-user-images/image-20250226100224510.png)

其中的queueing是请求在队列中等待的时间，原因是：

1. 浏览器对同一域名的并发请求有限制（通常是6-8个）
2. 并发请求数量达到上限，新的请求就会被放在队列中

所以在waterfall中会有一段灰色图是queueing，表示请求资源已经准备好但是由于浏览器的限制，尚未发送

测试：

- 在html文件中写入不同域名的十个图片

  ![image-20250226105458096](/Users/soup/Library/Application Support/typora-user-images/image-20250226105458096.png)

- 查看请求

  ![image-20250226110527679](/Users/soup/Library/Application Support/typora-user-images/image-20250226110527679.png)

  可以看到同一域名下十个请求有六个请求是并行的，四个请求有灰色的等待时间，

提问：为什么后四张是有先后顺序的调用？

前面六个请求开始请求，当有个请求完成之后，第五个请求开始发送，再有请求资源释放，第六个请求才开始发送。

### 3、如何查看请求是哪个协议的版本？

![image-20250226103339840](/Users/soup/Library/Application Support/typora-user-images/image-20250226103339840.png)

可以看到基本上是http1.1和http2，还有webscoket和chrome-extension

拓展：请求的协议是如何选择的？

### 4、同一个tcp连接中的请求是并发还是串行的？

- Http1.1

  1. 同一个tcp连接的请求是串行的

  1. tcp连接中是并行的

- Http2/http3

  1. 同一个tcp连接的请求是并行的
  2. tcp连接中是并行的

